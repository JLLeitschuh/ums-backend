<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.2.xsd http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet author="illay" id="Створення таблиці заяв абітурієнтів">
        <createTable remarks="Заява абітурієнта" tableName="q_dc_enrolment">
            <column name="id" remarks="Ідентифікатор" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="person_id" remarks="Ідентифікатор персони" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="docseries" remarks="Серія документу" type="VARCHAR(50)"/>
            <column name="docnum" remarks="Номер документу" type="VARCHAR(50)"/>
            <column name="doctext" remarks="Інформація про коди особливих умов вступу" type="VARCHAR(200)"/>
            <column name="issate" remarks="Бюджет" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="iscontract" remarks="Контракт(навчання за кошти фіз.особи)" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="specoffer_id" remarks="Ідентифікатор пропозиції" type="BIGINT"/>
            <column name="department_id" remarks="Ідентифікатор підрозділу" type="BIGINT"/>
            <column name="personpapper_id" remarks="Ідентифікатор документу персони" type="BIGINT"/>
            <column name="mark" remarks="Загальний бал" type="DOUBLE"/>
            <column name="isprivilege" remarks="Відмітка про наявність пільги" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="ishostel" remarks="Відмітка про потребу у гуртожитку" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="enrolmenttype_id" remarks="Ідентифікатор типу поступлення" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="evdate" remarks="Дата створення заяви" type="TIMESTAMP"/>
            <column name="begdate" type="TIMESTAMP"/>
            <column name="enddate" remarks="Дата закриття заяви(абітурієнт забрав заяву)" type="TIMESTAMP"/>
            <column name="parent_id" remarks="Ієрархічний ідентифікатор" type="BIGINT"/>
            <column name="uid" remarks="Унікальний ідентифікатор іншої ІС" type="BIGINT"/>
            <column name="utid" remarks="Унікальний текстовий ідентифікатор іншої ІС" type="VARCHAR(50)"/>
            <column name="uapp" remarks="Унікальна інша інформаційна система" type="VARCHAR(50)"/>
            <column name="status" remarks="Ознака статусу запису" type="varchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="actual" remarks="Актуальність даних" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="note" remarks="Примітка" type="VARCHAR(250)"/>
            <column name="crtuser" remarks="Користувач, що вніс зміни (значення за замовчуванням)" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="crtusergroup" remarks="Група до якої відноситься користувач, що вніс зміни (значення за замовчуванням)" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
           <column name="update_date" remarks="Дата внесення змін (значення за замовчуванням)" type="TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="create_date" remarks="Дата створення" type="TIMESTAMP">
            	<constraints nullable="false"/>
        	</column>   
        </createTable>
        
        <addPrimaryKey columnNames="id" constraintName="pk_q_dc_enrolment_id" tableName="q_dc_enrolment"/>
        
        <addForeignKeyConstraint baseColumnNames="specoffer_id" baseTableName="q_dc_enrolment" constraintName="fk_q_ob_specofer_id" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="q_ob_specoffer"/>
        
        <addForeignKeyConstraint baseColumnNames="enrolmenttype_id" baseTableName="q_dc_enrolment" constraintName="fk_q_rf_enrolmenttype_id" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="q_rf_enrolmenttype"/>
        
        <addForeignKeyConstraint baseColumnNames="parent_id" baseTableName="q_dc_enrolment" constraintName="fk_q_dc_enrolment_id" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="q_dc_enrolment"/>
        
        <addForeignKeyConstraint baseColumnNames="department_id" baseTableName="q_dc_enrolment" constraintName="fk_q_ob_department_id" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="q_ob_department"/>
        
        <addForeignKeyConstraint baseColumnNames="personpapper_id" baseTableName="q_dc_enrolment" constraintName="fk_q_od_personpaper_id" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="q_od_personpaper"/>
        
        <createIndex indexName="fki_q_ob_department_id" tableName="q_dc_enrolment" unique="false">
            <column name="department_id"/>
        </createIndex>
        
        <createIndex indexName="fki_q_ob_specofer_id" tableName="q_dc_enrolment" unique="false">
            <column name="specoffer_id"/>
        </createIndex>
        
        <createIndex indexName="fki_q_od_personpaper_id" tableName="q_dc_enrolment" unique="false">
            <column name="personpapper_id"/>
        </createIndex>
    </changeSet>
<!--    	<changeSet id="" author="illay">
   		<createTable tableName="q_dc_order">
   			<column name="id" remarks="Ідентифікатор" type="BIGINT">
   				<constraints nullable="false"/>
   			</column>
   			FK
   			<column name="ordertype_id" type="BIGINT" remarks="Ідентифікатор наказу">
   				<constraints nullable="false"/>
   			</column>
   			<column name="docseries" type="VARCHAR(50)" remarks=""></column> 
   			<column name="docnum" type="VARCHAR(50)" remarks=""></column>
   			<column name="docdate" type="TIMESTAMP" remarks=""></column>
   			<column name="docissued" type="VARCHAR(200)" remarks=""></column>
   			 FK
   			<column name="employee_id" type="BIGINT" remarks="">
   				<constraints nullable="false"/>
   			</column>
			 FK
   			<column name="asset_id" type="BIGINT" remarks="">
   				<constraints nullable="false"/>
   			</column>
   			FK
   			<column name="partner_id" type="BIGINT" remarks="">
   				<constraints nullable="false"/>
   			</column>
   			FK
   			<column name="optype_id" type="BIGINT" remarks="">
   				<constraints nullable="false"/>
   			</column>
   			<column name="evdate" type="TIMESTAMP" remarks=""></column>
   			<column name="begdate" type="TIMESTAMP" remarks=""></column>
   			<column name="enddate" type="TIMESTAMP" remarks=""></column>
   			FK
   			<column name="department_id" type="BIGINT" remarks="">
   				<constraints nullable="false"/>
   			</column>
   			FK
   			<column name="reason_id" type="BIGINT" remarks="">
   				<constraints nullable="false"/>
   			</column>
   			<column name="reasontext" type="VARCHAR(250)" remarks=""></column>
   			FK
   			<column name="parent_id" type="BIGINT" remarks="">
   				<constraints nullable="false"/>
   			</column>
   			            <column name="uid" remarks="Унікальний ідентифікатор іншої ІС" type="BIGINT"/>
            <column name="utid" remarks="Унікальний текстовий ідентифікатор іншої ІС" type="VARCHAR(50)"/>
            <column name="uapp" remarks="Унікальна інша інформаційна система" type="VARCHAR(50)"/>
            <column name="status" remarks="Ознака статусу запису" type="varchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="actual" remarks="Актуальність даних" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="note" remarks="Примітка" type="VARCHAR(250)"/>
            <column name="crtuser" remarks="Користувач, що вніс зміни (значення за замовчуванням)" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="crtusergroup" remarks="Група до якої відноситься користувач, що вніс зміни (значення за замовчуванням)" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
           <column name="update_date" remarks="Дата внесення змін (значення за замовчуванням)" type="TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="create_date" remarks="Дата створення" type="TIMESTAMP">
            	<constraints nullable="false"/>
        	</column> 
   		</createTable>
   	</changeSet>
   	-->
</databaseChangeLog>